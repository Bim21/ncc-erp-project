<abp-modal-header title="Thống kê cho report {{data.report.name}}" (onCloseClick)="dialogRef.close()">
</abp-modal-header>
<section class="content px-2 pt-2">
    <div class="container-fluid">
        <div class="row mb-4 card">
            <div class="col-12">
                <mat-tab-group>
                    <mat-tab label="Thông tin chung">
                        <div class="mt-2">
                            <div class="d-flex">
                                <strong>Đánh giá chung: </strong>
                                <pre class="mb-0 p-0  ml-2" style=" white-space: pre-line;
                                font-size: 1.1em; font-family: sans-serif; align-self:flex-start;">
                                       {{reportInfo.note}}
                               </pre>
                            </div>

                            <strong>Danh sách Issue:</strong>
                            <div class=" table-responsive p-4">
                                <div class="fixTableHead">


                                    <table [busy]="isLoading" style="border-collapse: collapse;"
                                        class="table table-hover text-nowrap">
                                        <thead>
                                            <tr>
                                                <th>STT</th>
                                                <th>Project</th>
                                                <th>Vấn đề</th>
                                                <th>Impact</th>
                                                <th>Solution</th>
                                                <th>Thời gian tạo</th>
                                                <th>projectHealth</th>
                                                <th>Trạng thái</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let issue of reportInfo.issues; let i=index">
                                                <td>{{i+1}}</td>
                                                <td>{{issue.projectName}}</td>
                                                <td>{{issue.description}}</td>
                                                <td>{{issue.impact}}</td>
                                                <td>{{issue.solution}}</td>
                                                <td class="text-center">{{issue.createdAt |date:"dd/MM/yyyy"}}</td>
                                                <td class="text-center"><span
                                                        [ngClass]="APP_CONST.projectHealth[issue.projectHealth]">
                                                        {{getByEnum(
                                                        issue.projectHealth,APP_ENUM.ProjectHealth)}}</span>
                                                </td>
                                                <td class="text-center"><span
                                                        [ngClass]="APP_CONST.statusStyle[issue.status]">{{issue.status}}</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </mat-tab>
                    <mat-tab label="Resource <20% trong tuần">
                        <section class="content mt-2">
                            <div class="container-fluid">
                                <div class="mt-2">
                                    <div class="row">
                                        <div class="col-6">
                                    <h5>List các user có resource < 20% trong tuần này</h5>

                                        </div>
                                        <div class="col-6">
                                            <mat-form-field class="w-100 px-3 " appearance="outline"
                                                            style="position: sticky; top: 0; z-index: 2; background-color: white;">
                                                            <input matInput [(ngModel)]="searchWeekResource" name="searchUser"
                                                                #search placeholder="search">
                                                        </mat-form-field>
                                        </div>
                                    </div>
                                            <div class=" table-responsive p-4">
                                                <div class="fixTableHead">


                                                    <table [busy]="isLoading" style="border-collapse: collapse;"
                                                        class="table table-hover text-nowrap">
                                                        <thead>
                                                            <tr>
                                                                <th>STT</th>
                                                                <th>Nhân viên</th>
                                                                <th>% sử dụng nhân sự</th>

                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr
                                                                *ngFor="let report of reportInfo.resourceInTheWeek; let i=index">
                                                                <td>{{i+1}}</td>
                                                                <td>
                                                                    <app-user-info [userData]="{fullName:report.fullName,branch:report.branch,
                                                        userType:report.userType,emailAddress:report.email}">
                                                                    </app-user-info>
                                                                </td>
                                                                <td class="text-center">{{report.allocatePercentage}}%
                                                                </td>

                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                </div>
                            </div>
                        </section>
                    </mat-tab>
                    <mat-tab label="Resource <20% trong tương lai">
                        <section class="content mt-2">
                            <div class="container-fluid">
                                <div class="mt-2">
                                    <div class="row">
                                        <div class="col-6">
                                            <h5>List các user có resource < 20% trong tương lai</h5>
                                        </div>
                                        <div class="col-6">
                                            <mat-form-field class="w-100 px-3 " appearance="outline"
                                                            style="position: sticky; top: 0; z-index: 2; background-color: white;">
                                                            <input matInput [(ngModel)]="searchFutureResource" name="searchFutureResource"
                                                                #searchFuture placeholder="search">
                                                        </mat-form-field>
                                        </div>
                                    </div>
                                            <div class=" table-responsive p-4">
                                                <div class="fixTableHead">
                                                    <table [busy]="isLoading" style="border-collapse: collapse;"
                                                        class="table table-hover text-nowrap">
                                                        <thead>
                                                            <tr>
                                                                <th>STT</th>
                                                                <th>Nhân viên</th>
                                                                <th>% sử dụng nhân sự</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr
                                                                *ngFor="let report of reportInfo.resourceInTheFuture; let i=index">
                                                                <td>{{i+1}}</td>
                                                                <td>
                                                                    <app-user-info [userData]="{fullName:report.fullName,branch:report.branch,
                                                        userType:report.userType,emailAddress:report.email}">
                                                                    </app-user-info>
                                                                </td>
                                                                <td class="text-center">{{report.allocatePercentage}}%
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                </div>
                            </div>
                        </section>
                    </mat-tab>

                </mat-tab-group>
                <hr />
            </div>
        </div>
    </div>
</section>