<form class="form-horizontal" autocomplete="off" #bankForm="ngForm">
    <abp-modal-header  [title]="data.command =='create' ?'Create new project':'Edit project: '+title"  (onCloseClick)="dialogRef.close()">
    </abp-modal-header>
    <div class="modal-body" style="max-height: 80vh; overflow-y: auto;">
        <div class="form-group row required">
            <label class="col-md-3 col-form-label" for="projectName">
                {{ 'Name' | localize }}:
            </label>
            <div class="col-md-9">
                <input type="text" class="form-control" name="projectName" id="projectName" 
                    required [(ngModel)]="project.name" #projectNameModel="ngModel" #projectNameEl />
                <abp-validation-summary [control]="projectNameModel" [controlEl]="projectNameEl">
                </abp-validation-summary>
            </div>
        </div>
        <div class="form-group row required">
            <label class="col-md-3 col-form-label" for="projectCode">
                {{ 'Code' | localize }}:
            </label>
            <div class="col-md-9">
                <input type="text" class="form-control" name="projectCode" id="projectCode" [(ngModel)]="project.code" #projectCode="ngModel"
                #projectCodeEl required />
                <abp-validation-summary [control]="projectCode" [controlEl]="projectCodeEl">
                </abp-validation-summary>
            </div>
        </div>

        <div class="form-group row required">
            <label class="col-md-3 col-form-label" for="PM">PM:</label>
            <div class="col-md-9 ">
                <mat-form-field class="w-100" appearance="outline">
                    <mat-select  [(ngModel)]="project.pmId" name="projectPM" placeholder="select a PM" required 
                        #projectPM="ngModel">
                        <mat-form-field class="w-100 px-3 "
                        style="position: sticky; top: 0; z-index: 2; background-color: white;">
                        <input matInput [(ngModel)]="searchPM" name="searchPMName" placeholder="Search" #search (keydown)="$event.stopPropagation()">{{search.focus()}}
                    </mat-form-field>
                        <mat-option *ngFor="let pm of pmList | listFilter:  'fullName' : searchPM : 'emailAddress' : 'surname' : 'name'" [value]="pm.id">
                            {{pm.fullName}} - ({{pm.emailAddress}})</mat-option>
                    </mat-select>
                </mat-form-field>
                <mat-error class="mt-1" *ngIf="projectPM.hasError('required') && projectPM.touched"
                    style="font-size: 13px;">
                    This field is required
                </mat-error>
            </div>
        </div>
        <div class="form-group row required">
            <label class="col-md-3 col-form-label">
                Start time:
            </label>
            <div class="col-md-9 datepick">
                <div class="col-md-9 datepick">
                    <mat-form-field appearance="outline">
                        <input matInput [matDatepicker]="picker" [(ngModel)]="project.startTime" placeholder="choose a date"
                            name="endTime">
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>
                </div>
                
            </div>
        </div>
        <div class="form-group row ">
            <label class="col-md-3 col-form-label">
                End time:
            </label>
            <div class="col-md-9 datepick">
                <mat-form-field appearance="outline">
                    <input matInput [matDatepicker]="picker2" [(ngModel)]="project.endTime" placeholder="choose a date"
                        name="endTime">
                    <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                    <mat-datepicker #picker2></mat-datepicker>
                </mat-form-field>
            </div>
        </div>
    </div>
    <div style="background-color: white;" align="end" class="d-flex justify-content-between" mat-dialog-actions="">
        <button class="btn btn-default cancel-banks" mat-raised-button mat-dialog-close>Cancel</button>
        <button class="btn btn-primary"
            [disabled]="!bankForm.valid || isLoading" (click)='saveAndClose()'>Save</button>
    </div>
</form>


